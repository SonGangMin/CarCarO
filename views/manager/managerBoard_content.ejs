<%- include('../include/managerhead.ejs') %>
<style>
  .comment {
    display: flex;
  }
  .txt {
    display: block;
  }
  .input {
    display: none;
  }
</style>
<h1><%= board.title %></h1>
<p><%= board.content %></p>
<p>작성자: <%= board.user.name %></p>
<p>최초 작성일: <%= board.createdAt %></p>
<p>최종 수정일: <%= board.updatedAt %></p>
<div class="comment">
  <button>
    <a href="/manager/managerboard/edit/<%= board.postId %>">수정</a>
  </button>
  <form
    action="/manager/managerboard/delete/<%= board.postId %>/"
    method="POST"
  >
    <input type="submit" value="삭제" />
  </form>
</div>
<br /><br /><br /><br /><br />

<h2>댓글~</h2>
<ul>
  <% comments.forEach(function(comment) { %>
  <li class="comment">
    작성자: <%= comment.user_id %> 내용:
    <form
      action="/manager/managerboard/comment/edit/<%= comment.number %>"
      method="post"
    >
      <div class="txt"><%= comment.content %></div>
      <div class="input" style="display: none">
        <input
          type="text"
          value="<%= comment.content %>"
          style="width: 350px"
          name="content"
        />
      </div>
      <input class="input" type="submit" value="적용" />
      <input class="input" type="button" value="취소" />
      <button class="edit">수정</button>
    </form>
    <form action="/board/comment/delete/<%= comment.number %>" method="POST">
      <input type="submit" value="삭제" />
    </form>
  </li>
  <% }); %>
</ul>

<script>
  document
    .querySelectorAll(".edit")
    .addEventListener("click", function (event) {
      event.preventDefault(); // 폼 전송 막기
    });

  const edits = document.querySelectorAll(".edit");
  edits.forEach((target) => {
    target.addEventListener("click", function () {
      const test = this.parentNode.childNodes;

      const txtcomment = test[1];
      const inputcomment = test[3];
      const inputsubmit = test[5];
      const inputcancel = test[7];
      const txtedit = test[9];
      const txtdelete = this.parentNode.parentNode.childNodes[3].childNodes[1];

      txtcomment.style.display = "none";
      inputcomment.style.display = "block";
      inputsubmit.style.display = "block";
      inputcancel.style.display = "block";
      txtedit.style.display = "none";
      txtdelete.style.display = "none";

      // console.log(test);
    });
  });
</script>
<form action="" method="post">
  <input type="text" name="content" />
  <input type="submit" value="등록" />
</form>
<br />
<button><a href="/manager/managerboard/">목록으로</a></button>
<br /><br /><br /><br />
